<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TikTok Scanner</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <style>
    body {
      background: #f8fafc;
    }
    .caption {
      max-height: 80px;
      overflow: hidden;
      text-overflow: ellipsis;
      position: relative;
    }
    .caption.expanded {
      max-height: none;
    }
    .caption-toggle {
      color: #2563eb;
      cursor: pointer;
      font-size: 13px;
    }
  </style>
</head>
<body class="flex justify-center py-8">

  <div class="bg-white shadow-md rounded-2xl p-6 w-full max-w-5xl">
    <h1 class="text-2xl font-bold text-blue-600 flex items-center gap-2 mb-1">
      üé¨ TikTok Scanner
    </h1>
    <p class="text-gray-500 mb-6">C√¥ng c·ª• qu√©t d·ªØ li·ªáu video TikTok nhanh & ti·ªán l·ª£i</p>

    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-4">
      <div>
        <label class="text-sm font-semibold">Username</label>
        <input id="username" type="text" placeholder="nh·∫≠p username..." class="w-full border rounded-lg px-3 py-2 mt-1" />
      </div>
      <div>
        <label class="text-sm font-semibold">S·ªë l∆∞·ª£ng video</label>
        <input id="count" type="number" value="5" class="w-full border rounded-lg px-3 py-2 mt-1" />
      </div>
      <div>
        <label class="text-sm font-semibold">T·ª´ ng√†y</label>
        <input id="from-date" type="date" class="w-full border rounded-lg px-3 py-2 mt-1" />
      </div>
      <div>
        <label class="text-sm font-semibold">ƒê·∫øn ng√†y</label>
        <input id="to-date" type="date" class="w-full border rounded-lg px-3 py-2 mt-1" />
      </div>
    </div>

    <div class="flex flex-wrap items-center gap-4 mb-4">
      <button id="start-btn" class="bg-blue-600 text-white px-5 py-2 rounded-lg hover:bg-blue-700 transition">
        üöÄ B·∫Øt ƒë·∫ßu qu√©t
      </button>
      <button id="btn-csv" class="bg-gray-200 px-5 py-2 rounded-lg hover:bg-gray-300 transition">
        üìÑ T·∫£i CSV
      </button>
      <button id="btn-excel" class="bg-gray-200 px-5 py-2 rounded-lg hover:bg-gray-300 transition">
        üìä T·∫£i Excel
      </button>
    </div>

    <p id="status" class="text-sm text-gray-600 mb-3">ƒê√£ l·∫•y 0 video.</p>

    <div class="overflow-x-auto">
      <table class="w-full text-sm border-collapse">
        <thead class="bg-gray-100 text-gray-700 font-semibold">
          <tr>
            <th class="px-3 py-2 text-left border">#</th>
            <th class="px-3 py-2 text-left border">Video URL</th>
            <th class="px-3 py-2 text-left border">Caption</th>
            <th class="px-3 py-2 text-left border">Ng√†y ƒëƒÉng</th>
            <th class="px-3 py-2 text-left border">Views</th>
            <th class="px-3 py-2 text-left border">Likes</th>
            <th class="px-3 py-2 text-left border">Comments</th>
            <th class="px-3 py-2 text-left border">Shares</th>
          </tr>
        </thead>
        <tbody id="data-body" class="align-top"></tbody>
      </table>
    </div>
  </div>

  <script>
    const videos = [
      {
        url: "https://www.tiktok.com/@maymanthinhvuong/video/1",
        caption: "ƒê√£ bao gi·ªù b·∫°n d·ª´ng l·∫°i, gi·ªØa m·ªôt ng√†y ch·∫≠t k√≠n ti·∫øng ·ªìn...",
        date: "21:22:30 3/11/2025",
        views: 4428,
        likes: 235,
        comments: 4,
        shares: 10
      },
      {
        url: "https://www.tiktok.com/@maymanthinhvuong/video/2",
        caption: "C√≥ ng∆∞·ªùi s·ªëng v√¨ cha m·∫π, v√¨ m·ªôt √°nh nh√¨n lo √¢u kh√¥ng bao gi·ªù n√≥i ra...",
        date: "21:20:33 3/11/2025",
        views: 12200,
        likes: 639,
        comments: 12,
        shares: 17
      }
    ];

    const tbody = document.getElementById("data-body");
    const status = document.getElementById("status");

    function renderTable() {
      tbody.innerHTML = videos.map((v, i) => `
        <tr class="border-b">
          <td class="px-3 py-2 border">${i + 1}</td>
          <td class="px-3 py-2 border text-blue-600"><a href="${v.url}" target="_blank">Xem</a></td>
          <td class="px-3 py-2 border">
            <div class="caption">${v.caption}</div>
            <div class="caption-toggle">Xem th√™m</div>
          </td>
          <td class="px-3 py-2 border">${v.date}</td>
          <td class="px-3 py-2 border">${v.views}</td>
          <td class="px-3 py-2 border">${v.likes}</td>
          <td class="px-3 py-2 border">${v.comments}</td>
          <td class="px-3 py-2 border">${v.shares}</td>
        </tr>
      `).join("");

      document.querySelectorAll(".caption-toggle").forEach(btn => {
        btn.addEventListener("click", e => {
          const caption = e.target.previousElementSibling;
          caption.classList.toggle("expanded");
          e.target.textContent = caption.classList.contains("expanded") ? "·∫®n b·ªõt" : "Xem th√™m";
        });
      });
    }

    renderTable();
    status.textContent = `ƒê√£ l·∫•y ${videos.length} video.`;

    // ‚úÖ C·∫≠p nh·∫≠t n√∫t T·∫£i CSV
    document.getElementById("btn-csv").addEventListener("click", () => {
      if (videos.length === 0) {
        alert("Ch∆∞a c√≥ d·ªØ li·ªáu ƒë·ªÉ t·∫£i!");
        return;
      }

      const csvContent = [
        ["STT", "Video URL", "Caption", "Ng√†y ƒëƒÉng", "Views", "Likes", "Comments", "Shares"].join(","),
        ...videos.map((v, i) =>
          [i + 1, v.url, `"${v.caption.replace(/"/g, '""')}"`, v.date, v.views, v.likes, v.comments, v.shares].join(",")
        )
      ].join("\n");

      const blob = new Blob([csvContent], { type: "text/csv;charset=utf-8;" });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = "tiktok_data.csv";
      link.click();
    });
  </script>

</body>
</html>
